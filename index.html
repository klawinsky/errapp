<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>eRegioJet — Logowanie (Demo)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="login-page">
  <main class="login-container">
    <div class="login-card">
      <div class="brand">
        <svg class="brand-logo" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M3 12a9 9 0 1 0 18 0 9 9 0 0 0-18 0z"/></svg>
        <div class="brand-text">
          <div class="brand-title">eRegioJet</div>
          <div class="brand-sub">Demo — raporty pociągów</div>
        </div>
      </div>

      <h1>Logowanie</h1>
      <p class="muted">Zaloguj się lub użyj trybu DEMO. Wersja demo nie łączy się z serwerem.</p>

      <label class="field">
        <span>Email</span>
        <input id="login-email" type="email" placeholder="twoj.mail@firma.pl" />
      </label>

      <label class="field">
        <span>Hasło</span>
        <input id="login-password" type="password" placeholder="Hasło" />
      </label>

      <div class="login-actions">
        <button id="login-btn" class="btn primary">Zaloguj (Supabase)</button>
        <button id="login-demo-btn" class="btn ghost">Wejdź (DEMO)</button>
      </div>

      <p class="hint">W demo: kliknij Wejdź (DEMO) lub wprowadź dane i kliknij Zaloguj (jeśli skonfigurowano Supabase Auth).</p>
    </div>

    <footer class="login-footer">
      <small>eRegioJet — demo. Bez zalogowania brak dostępu do aplikacji.</small>
    </footer>
  </main>

  <!-- Supabase SDK + prosta inicjalizacja anon key -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    // Zastąp wartości poniżej swoimi danymi z panelu Supabase
    const SUPABASE_URL = 'https://shqumvbmhcbeynrxozal.supabase.co';
    const SUPABASE_ANON_KEY = 'REPLACE_WITH_YOUR_ANON_KEY';
    window.supabase = supabaseJs.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  </script>

  <script>
    // Demo login: zapisujemy flagę w sessionStorage i przekierowujemy do app.html
    document.getElementById('login-demo-btn').addEventListener('click', () => {
      const email = document.getElementById('login-email').value.trim() || 'demo@eregiojet.local';
      sessionStorage.setItem('eRJ_user', email);
      window.location.href = 'app.html';
    });

    // Supabase email/password login (jeśli skonfigurowano Auth)
    document.getElementById('login-btn').addEventListener('click', async () => {
      const email = document.getElementById('login-email').value.trim();
      const pass = document.getElementById('login-password').value;
      if (!email || !pass) { alert('Podaj email i hasło.'); return; }
      const { data, error } = await window.supabase.auth.signInWithPassword({ email, password: pass });
      if (error) { alert('Błąd logowania: ' + error.message); return; }
      sessionStorage.setItem('eRJ_user', data.user.id);
      window.location.href = 'app.html';
    });

    // Jeśli już zalogowany (sessionStorage), przekieruj
    if (sessionStorage.getItem('eRJ_user')) {
      setTimeout(() => { window.location.href = 'app.html'; }, 150);
    }
  </script>
</body>
</html>
